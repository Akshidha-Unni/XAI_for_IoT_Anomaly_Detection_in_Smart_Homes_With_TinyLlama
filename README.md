# XAI for IOT 
## Anomaly Detection in Smart Homes With TinyLlama

##  Overview

This project implements an Explainable AI (XAI)â€“driven anomaly detection system for smart home IoT security using the CASAS dataset. A Random Forest model detects abnormal sensor activity, while SHAP  provide transparent feature-level explanations. A TinyLlama LLM further translates these insights into human-readable explanations, improving trust and interpretability in real-world IoT deployments.

## ğŸ“Š Features

- ğŸ“… **Date Selection**: Choose any date to analyze
- ğŸ“‹ **Anomaly List**: View all anomalies detected on the selected date
- ğŸ¯ **Anomaly Selection**: Choose a specific anomaly to analyze
- ğŸ¤– **LLM Explanation**: Get detailed AI-powered analysis using TinyLlama
- ğŸ“Š **SHAP Integration**: See which features contributed most to the anomaly classification
- ğŸ“ˆ **Detailed Metrics**: View timestamps, activities, and confidence scores

## ğŸ¯ Usage

1. Select a date using the date picker in the sidebar
2. Click "Find Anomalies" to see all anomalies for that date
3. Select an anomaly from the dropdown
4. Click "Generate LLM Explanation" to get the analysis
5. View the detailed report with LLM analysis and SHAP values

##  Tech Stack

| Component     | Tech                                      |
|---------------|-------------------------------------------|
| Frontend      | Streamlit                                 |
| Backend       | Transformers                              |
| Model         | RandomForest                              |
| LLM           | TinyLlama-1.1B-Chat-v1.0                  |
| Storage       | Temp local file storage for Dataset       |

## ğŸ› ï¸ Requirements

- Python 3.7+
- streamlit
- pandas
- transformers
- torch
- All dependencies from in requirements.txt

## ğŸ› ï¸ Setup Instructions

### 1. Clone the Repository
```bash
git clone https://github.com/your-username/DoctorGPT.git
cd DoctorGPT
```

### 2. Install Backend Dependencies
```bash
cd backend
python -m venv venv
source venv/bin/activate   # or venv\Scripts\activate on Windows
pip install -r requirements.txt
```

### 3. Run Frontend Application
```bash
streamlit run streamlit_app.py
# Opens http://localhost:3000
```

### Application Screenshot
**Screenshot 1 - Predicted Anomalies List Displayed Based on Chosen Date**
![image](<img width="1916" height="868" alt="Screenshot 2025-11-18 152127" src="https://github.com/user-attachments/assets/955ddc5a-921b-4ba4-8c41-7e58da4d2f67" />)

**Screenshot 2 - Explanation Generated by the LLM**
![image](<img width="1919" height="875" alt="Screenshot 2025-11-18 152705" src="https://github.com/user-attachments/assets/2800ea66-68cc-4148-a8ef-ee49203b7150" />7" />)

##  License
For educational and research use only.

##  Acknowledgements
- [TinyLlama](https://github.com/jzhang38/TinyLlama)  
- [CASAS Dataset](https://zenodo.org/records/17180309)  
